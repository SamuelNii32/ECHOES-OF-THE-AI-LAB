(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2625:(e,t,i)=>{Promise.resolve().then(i.bind(i,5903))},5903:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>x});var s=i(5155),l=i(2115);class a{static getDifficulty(e){return this.difficulties[e]}static getAllDifficulties(){return Object.values(this.difficulties)}static calculateTimeLimit(e,t){return Math.floor(e*this.getDifficulty(t).timeMultiplier)}static calculateDroneCount(e,t){return Math.max(1,e+this.getDifficulty(t).droneCountModifier)}static calculateDroneSpeed(e,t){return e*this.getDifficulty(t).droneSpeedMultiplier}static getAIInterval(e){return this.getDifficulty(e).aiInterferenceInterval}static getPlatformDisappearSpeed(e){return this.getDifficulty(e).platformDisappearSpeed}static shouldSpawnPowerUp(e){return Math.random()<this.getDifficulty(e).powerUpSpawnRate}static getStartingLives(e){return this.getDifficulty(e).livesCount}}a.difficulties={beginner:{name:"beginner",displayName:"BEGINNER",description:"Perfect for new test subjects",timeMultiplier:1.5,droneSpeedMultiplier:.7,droneCountModifier:-1,aiInterferenceInterval:25e3,platformDisappearSpeed:.5,powerUpSpawnRate:1.2,livesCount:5,color:"#00ff00"},medium:{name:"medium",displayName:"MEDIUM",description:"Standard containment protocols",timeMultiplier:1,droneSpeedMultiplier:1,droneCountModifier:0,aiInterferenceInterval:15e3,platformDisappearSpeed:1,powerUpSpawnRate:1,livesCount:3,color:"#ffff00"},hard:{name:"hard",displayName:"HARD",description:"Maximum security protocols",timeMultiplier:.75,droneSpeedMultiplier:1.4,droneCountModifier:1,aiInterferenceInterval:1e4,platformDisappearSpeed:1.5,powerUpSpawnRate:.8,livesCount:2,color:"#ff0000"}};class h{getLives(){return this.lives}isDead(){return this.lives<=0}takeDamage(){return!this.invulnerable&&!this.shieldActive&&(this.lives--,this.invulnerable=!0,this.invulnerabilityTimer=3e3,this.x=100,this.y=400,this.velocityX=0,this.velocityY=0,!0)}reset(e){this.x=100,this.y=400,this.velocityX=0,this.velocityY=0,this.lives=e?a.getStartingLives(e):3,this.invulnerable=!1,this.invulnerabilityTimer=0,this.highJumpCharges=0,this.speedBoostActive=!1,this.speedBoostTimer=0,this.shieldActive=!1,this.shieldTimer=0,this.lastJumpTime=0}moveLeft(){let e=this.speedBoostActive?1.5*this.speed:this.speed;this.velocityX=-e}moveRight(){let e=this.speedBoostActive?1.5*this.speed:this.speed;this.velocityX=e}jump(){let e=Date.now(),t=e-this.lastJumpTime;this.onGround&&(this.velocityY=-this.jumpPower,this.onGround=!1,t<this.doubleTapWindow&&this.highJumpCharges>0&&(this.velocityY=-(1.6*this.jumpPower),this.highJumpCharges--),this.lastJumpTime=e)}highJump(){this.onGround&&this.highJumpCharges>0&&(this.velocityY=-(1.6*this.jumpPower),this.highJumpCharges--,this.onGround=!1)}setGravity(e){this.gravity=e}activatePowerUp(e){"high_jump"===e?this.highJumpCharges++:"speed_boost"===e?(this.speedBoostActive=!0,this.speedBoostTimer=8e3):"shield"===e&&(this.shieldActive=!0,this.shieldTimer=15e3)}getActivePowerUps(){let e=[];return this.highJumpCharges>0&&e.push("HIGH JUMP x".concat(this.highJumpCharges)),this.speedBoostActive&&e.push("SPEED BOOST"),this.shieldActive&&e.push("SHIELD"),e}update(e,t){for(let i of(arguments.length>2&&void 0!==arguments[2]&&arguments[2],this.invulnerable&&(this.invulnerabilityTimer-=e,this.invulnerabilityTimer<=0&&(this.invulnerable=!1)),this.speedBoostActive&&(this.speedBoostTimer-=e,this.speedBoostTimer<=0&&(this.speedBoostActive=!1)),this.shieldActive&&(this.shieldTimer-=e,this.shieldTimer<=0&&(this.shieldActive=!1)),this.velocityY+=this.gravity,this.x+=this.velocityX,this.y+=this.velocityY,this.velocityX*=.8,this.onGround=!1,t))this.checkCollision(i)&&this.velocityY>0&&this.y<i.y&&(this.y=i.y-this.height,this.velocityY=0,this.onGround=!0);this.x<0&&(this.x=0),this.x+this.width>800&&(this.x=800-this.width),this.y>600&&this.takeDamage()}checkCollision(e){return this.x<e.x+e.width&&this.x+this.width>e.x&&this.y<e.y+e.height&&this.y+this.height>e.y}render(e){if(this.invulnerable&&Math.floor(Date.now()/200)%2)return;let t="#00ff00";this.shieldActive?t="#ff8800":this.speedBoostActive?t="#ffff00":this.highJumpCharges>0&&(t="#00ffff"),e.fillStyle=t,e.fillRect(this.x,this.y,this.width,this.height),e.shadowColor=t,e.shadowBlur=this.shieldActive?15:10,e.fillStyle=this.shieldActive?"#ffcc88":"#88ff88",e.fillRect(this.x+4,this.y+4,this.width-8,this.height-8),e.shadowBlur=0,this.highJumpCharges>0&&(e.fillStyle="#00ffff",e.font="12px monospace",e.fillText("".concat(this.highJumpCharges),this.x+this.width+5,this.y+15))}getBounds(){return{x:this.x,y:this.y,width:this.width,height:this.height}}getHighJumpCharges(){return this.highJumpCharges}teleport(e,t){this.x=e,this.y=t,this.velocityX=0,this.velocityY=0}constructor(e,t,i="medium"){this.width=32,this.height=32,this.velocityX=0,this.velocityY=0,this.speed=5,this.jumpPower=15,this.gravity=.8,this.onGround=!1,this.lives=3,this.invulnerable=!1,this.invulnerabilityTimer=0,this.highJumpCharges=0,this.speedBoostActive=!1,this.speedBoostTimer=0,this.shieldActive=!1,this.shieldTimer=0,this.lastJumpTime=0,this.doubleTapWindow=300,this.x=e,this.y=t,this.lives=a.getStartingLives(i)}}class o{spawnPowerUps(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"medium";this.powerUps=[];let i=[];for(let s of(1===e?i.push({x:400,y:200,type:"high_jump"},{x:125,y:120,type:"speed_boost"}):2===e?i.push({x:300,y:220,type:"high_jump"},{x:500,y:220,type:"speed_boost"},{x:400,y:90,type:"shield"}):3===e&&i.push({x:180,y:240,type:"high_jump"},{x:380,y:220,type:"speed_boost"},{x:580,y:240,type:"shield"},{x:250,y:40,type:"high_jump"}),i))a.shouldSpawnPowerUp(t)&&this.powerUps.push({...s,collected:!1,glowPhase:0,size:16});"beginner"===t&&e>=2&&this.powerUps.push({x:50+700*Math.random(),y:100+200*Math.random(),type:.5>Math.random()?"shield":"speed_boost",collected:!1,glowPhase:0,size:16})}update(e){for(let t of this.powerUps)t.collected||(t.glowPhase+=.008*e)}checkCollection(e){let t=[];for(let i of this.powerUps)!i.collected&&Math.sqrt(Math.pow(e.x+e.width/2-i.x,2)+Math.pow(e.y+e.height/2-i.y,2))<i.size+16&&(i.collected=!0,t.push(i));return t}render(e){for(let t of this.powerUps)if(!t.collected){let i=.5*Math.sin(t.glowPhase)+.5,s="#ff00ff";"high_jump"===t.type?s="#00ffff":"speed_boost"===t.type?s="#ffff00":"shield"===t.type&&(s="#ff8800"),e.shadowColor=s,e.shadowBlur=12*i,e.fillStyle=s,e.save(),e.translate(t.x,t.y),e.rotate(Math.PI/4+.5*t.glowPhase),e.fillRect(-t.size/2,-t.size/2,t.size,t.size),e.restore(),e.shadowBlur=0}}constructor(){this.powerUps=[]}}class r{createLevel(e){this.platforms=[],this.orbs=[],this.drones=[],this.disappearingMode=!1,1===e?this.createLevel1():2===e?this.createLevel2():3===e&&this.createLevel3(),this.powerUpManager.spawnPowerUps(e,this.difficulty)}createLevel1(){this.platforms=[{x:0,y:580,width:800,height:20,visible:!0},{x:200,y:500,width:150,height:20,visible:!0},{x:400,y:420,width:150,height:20,visible:!0},{x:100,y:340,width:150,height:20,visible:!0},{x:550,y:340,width:150,height:20,visible:!0},{x:300,y:260,width:200,height:20,visible:!0},{x:50,y:180,width:150,height:20,visible:!0},{x:600,y:180,width:150,height:20,visible:!0},{x:350,y:100,width:100,height:20,visible:!0}],this.orbs=[{x:275,y:470,radius:10,collected:!1,glowPhase:0},{x:475,y:390,radius:10,collected:!1,glowPhase:0},{x:175,y:310,radius:10,collected:!1,glowPhase:0},{x:625,y:310,radius:10,collected:!1,glowPhase:0},{x:400,y:230,radius:10,collected:!1,glowPhase:0},{x:125,y:150,radius:10,collected:!1,glowPhase:0},{x:675,y:150,radius:10,collected:!1,glowPhase:0},{x:400,y:70,radius:10,collected:!1,glowPhase:0}]}createLevel2(){this.platforms=[{x:0,y:580,width:150,height:20,visible:!0},{x:200,y:580,width:150,height:20,visible:!0},{x:450,y:580,width:150,height:20,visible:!0},{x:650,y:580,width:150,height:20,visible:!0},{x:100,y:480,width:100,height:20,visible:!0},{x:300,y:450,width:80,height:20,visible:!0},{x:500,y:480,width:100,height:20,visible:!0},{x:150,y:380,width:80,height:20,visible:!0},{x:400,y:350,width:80,height:20,visible:!0},{x:600,y:380,width:80,height:20,visible:!0},{x:50,y:280,width:100,height:20,visible:!0},{x:250,y:250,width:100,height:20,visible:!0},{x:450,y:250,width:100,height:20,visible:!0},{x:650,y:280,width:100,height:20,visible:!0},{x:350,y:150,width:100,height:20,visible:!0},{x:200,y:80,width:80,height:20,visible:!0},{x:520,y:80,width:80,height:20,visible:!0}],this.orbs=[{x:150,y:450,radius:10,collected:!1,glowPhase:0},{x:340,y:420,radius:10,collected:!1,glowPhase:0},{x:550,y:450,radius:10,collected:!1,glowPhase:0},{x:190,y:350,radius:10,collected:!1,glowPhase:0},{x:440,y:320,radius:10,collected:!1,glowPhase:0},{x:640,y:350,radius:10,collected:!1,glowPhase:0},{x:100,y:250,radius:10,collected:!1,glowPhase:0},{x:300,y:220,radius:10,collected:!1,glowPhase:0},{x:500,y:220,radius:10,collected:!1,glowPhase:0},{x:700,y:250,radius:10,collected:!1,glowPhase:0},{x:400,y:120,radius:10,collected:!1,glowPhase:0},{x:240,y:50,radius:10,collected:!1,glowPhase:0},{x:560,y:50,radius:10,collected:!1,glowPhase:0}]}createLevel3(){this.platforms=[{x:0,y:580,width:100,height:20,visible:!0},{x:150,y:580,width:80,height:20,visible:!0},{x:280,y:580,width:80,height:20,visible:!0},{x:420,y:580,width:80,height:20,visible:!0},{x:550,y:580,width:80,height:20,visible:!0},{x:680,y:580,width:120,height:20,visible:!0},{x:50,y:500,width:60,height:20,visible:!0},{x:200,y:480,width:60,height:20,visible:!0},{x:350,y:460,width:60,height:20,visible:!0},{x:500,y:480,width:60,height:20,visible:!0},{x:650,y:500,width:60,height:20,visible:!0},{x:100,y:400,width:50,height:20,visible:!0},{x:250,y:380,width:50,height:20,visible:!0},{x:400,y:360,width:50,height:20,visible:!0},{x:550,y:380,width:50,height:20,visible:!0},{x:700,y:400,width:50,height:20,visible:!0},{x:150,y:300,width:60,height:20,visible:!0},{x:350,y:280,width:60,height:20,visible:!0},{x:550,y:300,width:60,height:20,visible:!0},{x:100,y:200,width:80,height:20,visible:!0},{x:300,y:180,width:80,height:20,visible:!0},{x:500,y:200,width:80,height:20,visible:!0},{x:200,y:100,width:100,height:20,visible:!0},{x:400,y:80,width:100,height:20,visible:!0},{x:300,y:20,width:200,height:20,visible:!0}],this.orbs=[{x:80,y:470,radius:10,collected:!1,glowPhase:0},{x:230,y:450,radius:10,collected:!1,glowPhase:0},{x:380,y:430,radius:10,collected:!1,glowPhase:0},{x:530,y:450,radius:10,collected:!1,glowPhase:0},{x:680,y:470,radius:10,collected:!1,glowPhase:0},{x:130,y:370,radius:10,collected:!1,glowPhase:0},{x:280,y:350,radius:10,collected:!1,glowPhase:0},{x:430,y:330,radius:10,collected:!1,glowPhase:0},{x:580,y:350,radius:10,collected:!1,glowPhase:0},{x:730,y:370,radius:10,collected:!1,glowPhase:0},{x:180,y:270,radius:10,collected:!1,glowPhase:0},{x:380,y:250,radius:10,collected:!1,glowPhase:0},{x:580,y:270,radius:10,collected:!1,glowPhase:0},{x:140,y:170,radius:10,collected:!1,glowPhase:0},{x:340,y:150,radius:10,collected:!1,glowPhase:0},{x:540,y:170,radius:10,collected:!1,glowPhase:0},{x:250,y:70,radius:10,collected:!1,glowPhase:0},{x:450,y:50,radius:10,collected:!1,glowPhase:0},{x:400,y:-10,radius:10,collected:!1,glowPhase:0}]}startDisappearingPlatforms(){this.disappearingMode=!0;let e=a.getPlatformDisappearSpeed(this.difficulty);for(let t=1;t<this.platforms.length;t++).5>Math.random()&&(this.platforms[t].disappearTimer=(3e3*Math.random()+1e3)/e)}spawnDrones(){this.drones=[],console.log("Spawning drones for level ".concat(this.levelNumber," on ").concat(this.difficulty," difficulty!"));let e=this.levelNumber+1,t=a.calculateDroneCount(e,this.difficulty),i=1+.5*this.levelNumber,s=a.calculateDroneSpeed(i,this.difficulty);for(let e=0;e<t;e++)this.drones.push({x:100+600/t*e,y:80+e%2*100,velocityX:0,velocityY:0,size:20,targetX:400,targetY:300,aggressionLevel:1+.2*e,lastPlayerSeen:Date.now(),attackCooldown:0,baseSpeed:s});console.log("Spawned ".concat(this.drones.length," drones with speed ").concat(s.toFixed(1)," (").concat(this.difficulty," difficulty)"))}resetPlatforms(){for(let e of(this.disappearingMode=!1,this.drones=[],this.platforms))e.visible=!0,e.disappearTimer=void 0}update(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let t of this.orbs)t.collected||(t.glowPhase+=.005*e);if(this.powerUpManager.update(e),this.disappearingMode){let t=a.getPlatformDisappearSpeed(this.difficulty);for(let i of this.platforms)void 0!==i.disappearTimer&&(i.disappearTimer-=e*t,i.disappearTimer<=0&&(i.visible=!i.visible,i.disappearTimer=(2e3*Math.random()+1e3)/t))}t&&this.updateDroneAI(e,t,i)}updateDroneAI(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(i){for(let e of this.drones)e.velocityX*=.9,e.velocityY*=.9,e.attackCooldown=2e3;return}let s=t.x+t.width/2,l=t.y+t.height/2;for(let t of this.drones){t.attackCooldown>0&&(t.attackCooldown-=e),t.x,t.size,t.y,t.size,t.targetX=s-t.size/2,t.targetY=l-t.size/2,t.lastPlayerSeen=Date.now();let i=t.targetX-t.x,a=t.targetY-t.y,h=Math.sqrt(i*i+a*a);if(h>5){let e=t.baseSpeed*t.aggressionLevel;t.velocityX=i/h*e,t.velocityY=a/h*e}t.x+=t.velocityX,t.y+=t.velocityY,(t.x<=10||t.x>=790-t.size)&&(t.velocityX*=-.8,t.x=Math.max(10,Math.min(790-t.size,t.x))),(t.y<=10||t.y>=590-t.size)&&(t.velocityY*=-.8,t.y=Math.max(10,Math.min(590-t.size,t.y)));let o=t.baseSpeed*t.aggressionLevel*1.5,r=Math.sqrt(t.velocityX*t.velocityX+t.velocityY*t.velocityY);r>o&&(t.velocityX=t.velocityX/r*o,t.velocityY=t.velocityY/r*o)}}checkDroneCollision(e){for(let t of this.drones)if(t.attackCooldown<=0&&e.x<t.x+t.size&&e.x+e.width>t.x&&e.y<t.y+t.size&&e.y+e.height>t.y)return t.attackCooldown=1500,console.log("Drone collision detected!"),!0;return!1}checkOrbCollection(e){let t=0;for(let i of this.orbs)!i.collected&&Math.sqrt(Math.pow(e.x+e.width/2-i.x,2)+Math.pow(e.y+e.height/2-i.y,2))<i.radius+16&&(i.collected=!0,t++);return t}checkPowerUpCollection(e){return this.powerUpManager.checkCollection(e)}render(e){for(let t of this.platforms)t.visible?(e.fillStyle="#4ade80",e.fillRect(t.x,t.y,t.width,t.height),e.shadowColor="#4ade80",e.shadowBlur=5,e.fillStyle="#86efac",e.fillRect(t.x+2,t.y+2,t.width-4,t.height-4),e.shadowBlur=0):this.disappearingMode&&(e.fillStyle="rgba(74, 222, 128, 0.3)",e.fillRect(t.x,t.y,t.width,t.height));for(let t of this.orbs)if(!t.collected){let i=.5*Math.sin(t.glowPhase)+.5;e.shadowColor="#fbbf24",e.shadowBlur=15*i,e.fillStyle="rgba(251, 191, 36, ".concat(.8+.2*i,")"),e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI),e.fill(),e.shadowBlur=0}for(let t of(this.powerUpManager.render(e),this.drones)){let i=a.getDifficulty(this.difficulty).color;if("hard"===this.difficulty?i="#ff0000":"medium"===this.difficulty?i="#ffaa00":"beginner"===this.difficulty&&(i="#00ff00"),t.attackCooldown>0){let e=Number.parseInt(i.slice(1,3),16),t=Number.parseInt(i.slice(3,5),16),s=Number.parseInt(i.slice(5,7),16);i="rgb(".concat(Math.min(255,e+80),", ").concat(Math.min(255,t+80),", ").concat(Math.min(255,s+80),")")}e.fillStyle=i,e.fillRect(t.x,t.y,t.size,t.size),e.shadowColor=i,e.shadowBlur="hard"===this.difficulty?15:"medium"===this.difficulty?10:6,e.fillStyle=t.attackCooldown>0?"#ffcccc":"#fca5a5",e.fillRect(t.x+3,t.y+3,t.size-6,t.size-6),e.shadowBlur=0,e.fillStyle="#ffffff",e.font="8px monospace",e.fillText("".concat(this.difficulty[0].toUpperCase()).concat(this.levelNumber),t.x+t.size+2,t.y+8),t.attackCooldown>0&&(e.fillStyle="#ffff00",e.font="8px monospace",e.fillText("!",t.x+t.size+2,t.y+18))}}allOrbsCollected(){return this.orbs.every(e=>e.collected)}getDroneCount(){return this.drones.length}getDroneSpeed(){return this.drones.length>0?this.drones[0].baseSpeed:0}getDifficulty(){return this.difficulty}constructor(e=1,t="medium"){this.platforms=[],this.orbs=[],this.drones=[],this.disappearingMode=!1,this.levelNumber=e,this.difficulty=t,this.powerUpManager=new o,this.createLevel(e)}}class n{start(){this.requestAIUpdate(),this.intervalId=window.setInterval(()=>{this.requestAIUpdate()},this.requestInterval)}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}update(e){}setDifficulty(e){this.difficulty=e,this.requestInterval=Math.max(1e4,15e3-(e-1)*3e3)}async requestAIUpdate(){try{let e=await fetch("/api/ai-update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:"Generate a one-sentence story update and a random game modifier for level ".concat(this.difficulty," of the AI lab escape game. Higher levels should have more dangerous modifiers. Available modifiers: low gravity, disappearing platforms, spawning drones, normal.")})});if(e.ok){let t=await e.json();this.onResponse(t)}else this.onResponse({narrative:"The AI systems flicker momentarily as Subject Delta continues their escape attempt.",modifier:"normal"})}catch(e){console.error("AI request failed:",e),this.onResponse({narrative:"System interference detected. Protocols adapting to Subject Delta's progress.",modifier:.3>Math.random()?"low gravity":.6>Math.random()?"disappearing platforms":"spawning drones"})}}constructor(e,t=1){this.intervalId=null,this.lastRequestTime=0,this.requestInterval=15e3,this.difficulty=1,this.onResponse=e,this.difficulty=t,this.requestInterval=Math.max(1e4,15e3-(t-1)*3e3)}}class c{createOscillator(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"square";if(!this.audioContext||!this.enabled)return null;let i=this.audioContext.createOscillator();return i.type=t,i.frequency.setValueAtTime(e,this.audioContext.currentTime),i}createGain(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;if(!this.audioContext||!this.enabled)return null;let t=this.audioContext.createGain();return t.gain.setValueAtTime(e,this.audioContext.currentTime),t}playJump(){if(!this.audioContext||!this.enabled)return;let e=this.createOscillator(400,"sine"),t=this.createGain(.1);e&&t&&(e.connect(t),t.connect(this.audioContext.destination),e.frequency.exponentialRampToValueAtTime(600,this.audioContext.currentTime+.1),t.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.15),e.start(),e.stop(this.audioContext.currentTime+.15))}playHighJump(){if(!this.audioContext||!this.enabled)return;let e=this.createOscillator(500,"sine"),t=this.createGain(.15);e&&t&&(e.connect(t),t.connect(this.audioContext.destination),e.frequency.exponentialRampToValueAtTime(800,this.audioContext.currentTime+.2),t.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.25),e.start(),e.stop(this.audioContext.currentTime+.25))}playOrbCollect(){if(!this.audioContext||!this.enabled)return;let e=this.createOscillator(800,"sine"),t=this.createGain(.08);e&&t&&(e.connect(t),t.connect(this.audioContext.destination),e.frequency.exponentialRampToValueAtTime(1200,this.audioContext.currentTime+.1),t.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.2),e.start(),e.stop(this.audioContext.currentTime+.2))}playPowerUp(){this.audioContext&&this.enabled&&[600,800,1e3,1200].forEach((e,t)=>{setTimeout(()=>{let t=this.createOscillator(e,"sine"),i=this.createGain(.06);t&&i&&(t.connect(i),i.connect(this.audioContext.destination),i.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.1),t.start(),t.stop(this.audioContext.currentTime+.1))},50*t)})}playDroneHit(){if(!this.audioContext||!this.enabled)return;let e=this.createOscillator(200,"sawtooth"),t=this.createGain(.12);e&&t&&(e.connect(t),t.connect(this.audioContext.destination),e.frequency.exponentialRampToValueAtTime(100,this.audioContext.currentTime+.3),t.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.3),e.start(),e.stop(this.audioContext.currentTime+.3))}playDroneSpawn(){if(!this.audioContext||!this.enabled)return;let e=this.createOscillator(150,"sawtooth"),t=this.createGain(.1);e&&t&&(e.connect(t),t.connect(this.audioContext.destination),e.frequency.exponentialRampToValueAtTime(300,this.audioContext.currentTime+.5),t.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.5),e.start(),e.stop(this.audioContext.currentTime+.5))}playLevelComplete(){this.audioContext&&this.enabled&&[523,659,784,1047].forEach((e,t)=>{setTimeout(()=>{let t=this.createOscillator(e,"sine"),i=this.createGain(.1);t&&i&&(t.connect(i),i.connect(this.audioContext.destination),i.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.3),t.start(),t.stop(this.audioContext.currentTime+.3))},200*t)})}playGameOver(){if(!this.audioContext||!this.enabled)return;let e=this.createOscillator(300,"sawtooth"),t=this.createGain(.15);e&&t&&(e.connect(t),t.connect(this.audioContext.destination),e.frequency.exponentialRampToValueAtTime(100,this.audioContext.currentTime+1),t.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+1),e.start(),e.stop(this.audioContext.currentTime+1))}playTimeWarning(){if(this.audioContext&&this.enabled)for(let e=0;e<3;e++)setTimeout(()=>{let e=this.createOscillator(1e3,"square"),t=this.createGain(.08);e&&t&&(e.connect(t),t.connect(this.audioContext.destination),t.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.1),e.start(),e.stop(this.audioContext.currentTime+.1))},150*e)}constructor(){this.audioContext=null,this.enabled=!0;try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch(e){console.warn("Audio not supported"),this.enabled=!1}}}class d{setupEventListeners(){this.canvas.focus(),this.canvas.addEventListener("keydown",e=>{this.keys[e.code]||(this.keysPressed[e.code]=!0),this.keys[e.code]=!0,e.preventDefault()}),this.canvas.addEventListener("keyup",e=>{this.keys[e.code]=!1,this.keysPressed[e.code]=!1,e.preventDefault()}),this.canvas.tabIndex=0}handleAIResponse(e){this.callbacks.onNarrativeUpdate(e.narrative),this.applyModifier(e.modifier)}applyModifier(e){this.modifiers={lowGravity:!1,disappearingPlatforms:!1,spawningDrones:!1},e.includes("low gravity")?(this.modifiers.lowGravity=!0,this.player.setGravity(.3)):e.includes("disappearing platforms")?(this.modifiers.disappearingPlatforms=!0,this.level.startDisappearingPlatforms()):e.includes("spawning drones")?(this.modifiers.spawningDrones=!0,this.level.spawnDrones(),this.soundManager.playDroneSpawn(),this.callbacks.onNarrativeUpdate("WARNING: ".concat(this.level.getDroneCount()," security drones deployed at speed level ").concat(this.currentLevel,"!"))):(this.player.setGravity(.8),this.level.resetPlatforms())}handleGameOver(){this.gameState="gameOver",this.aiController.stop(),this.soundManager.playGameOver(),this.callbacks.onNarrativeUpdate("SUBJECT DELTA TERMINATED. EXPERIMENT CONCLUDED.")}restartGame(){this.gameState="playing",this.player.reset(this.difficulty),this.score=0,this.callbacks.onScoreUpdate(0),this.currentLevel=1,this.levelComplete=!1,this.levelTransition=!1,this.transitionTimer=0,this.level=new r(1,this.difficulty),this.resetLevelTimer(),this.aiController.start(),this.callbacks.onNarrativeUpdate("SUBJECT DELTA REINITIALIZED. RESUMING EXPERIMENT.")}update(e){if("gameOver"===this.gameState||"victory"===this.gameState){(this.keys.KeyR||this.keys.Space)&&this.restartGame();return}if((this.keys.ArrowLeft||this.keys.KeyA)&&this.player.moveLeft(),(this.keys.ArrowRight||this.keys.KeyD)&&this.player.moveRight(),(this.keysPressed.Space||this.keysPressed.ArrowUp||this.keysPressed.KeyW)&&(this.player.jump(),this.soundManager.playJump()),(this.keysPressed.KeyQ||this.keysPressed.KeyE)&&this.player.getHighJumpCharges()>0&&(this.player.highJump(),this.soundManager.playHighJump()),this.keysPressed={},"playing"===this.gameState&&!this.levelTransition&&(this.levelTimeRemaining-=e,this.levelTimeRemaining<=15e3&&!this.timeWarningShown&&(this.timeWarningShown=!0,this.soundManager.playTimeWarning(),this.callbacks.onNarrativeUpdate("WARNING: TIME RUNNING OUT! ESCAPE IMMEDIATELY!")),this.levelTimeRemaining<=0&&(this.callbacks.onNarrativeUpdate("TIME EXPIRED! Subject Delta failed to escape in time!"),this.player.takeDamage(),this.resetLevelTimer())),this.player.update(e,this.level.platforms),this.level.update(e,this.player.getBounds(),this.levelTransition),!this.player.isDead()&&!this.levelTransition&&this.level.checkDroneCollision(this.player.getBounds())&&this.player.takeDamage()&&(this.soundManager.playDroneHit(),this.callbacks.onNarrativeUpdate("DRONE CONTACT! Subject Delta damaged!")),this.player.isDead()){this.handleGameOver();return}let t=this.level.checkOrbCollection(this.player.getBounds());for(let e of(t>0&&(this.score+=t,this.soundManager.playOrbCollect(),this.callbacks.onScoreUpdate(this.score)),this.level.checkPowerUpCollection(this.player.getBounds())))this.player.activatePowerUp(e.type),this.soundManager.playPowerUp(),this.callbacks.onNarrativeUpdate("POWER-UP ACQUIRED: ".concat(e.type.toUpperCase().replace("_"," "),"!"));this.level.allOrbsCollected()&&!this.levelComplete&&(this.levelComplete=!0,this.levelTransition=!0,this.transitionTimer=3e3,this.soundManager.playLevelComplete(),this.currentLevel>=this.maxLevel?(console.log("FINAL LEVEL COMPLETED - TRIGGERING VICTORY!"),this.callbacks.onNarrativeUpdate("\uD83D\uDEA8 CRITICAL ALERT: FINAL CONTAINMENT LEVEL BREACHED! SUBJECT DELTA APPROACHING TOTAL ESCAPE! \uD83D\uDEA8")):this.callbacks.onNarrativeUpdate("LEVEL ".concat(this.currentLevel," BREACHED! ESCALATING TO LEVEL ").concat(this.currentLevel+1," PROTOCOLS!")),this.aiController.stop()),this.levelTransition&&(this.transitionTimer-=e,this.transitionTimer<=0&&this.advanceLevel()),this.aiController.update(e)}render(){this.ctx.fillStyle="#1f2937",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.level.render(this.ctx),this.player.render(this.ctx),this.renderModifierEffects(),this.renderUI()}renderUI(){this.ctx.fillStyle="#00ff00",this.ctx.font="16px monospace",this.ctx.fillText("LEVEL: ".concat(this.currentLevel,"/").concat(this.maxLevel),10,500),this.ctx.fillText("LIVES: ".concat(this.player.getLives()),10,520);let e=Math.max(0,Math.ceil(this.levelTimeRemaining/1e3));this.ctx.fillStyle=e<=15?"#ff0000":"#00ff00",this.ctx.font="16px monospace",this.ctx.fillText("TIME: ".concat(e,"s"),150,500);let t=a.getDifficulty(this.difficulty);this.ctx.fillStyle=t.color,this.ctx.font="14px monospace",this.ctx.fillText("DIFFICULTY: ".concat(t.displayName),300,500),this.level.getDroneCount()>0&&(this.ctx.fillStyle="#ff8800",this.ctx.font="14px monospace",this.ctx.fillText("DRONES: ".concat(this.level.getDroneCount()," (Speed: ").concat(this.level.getDroneSpeed().toFixed(1),")"),10,580));let i=this.player.getHighJumpCharges();i>0&&(this.ctx.fillStyle="#00ffff",this.ctx.font="14px monospace",this.ctx.fillText("HIGH JUMPS: ".concat(i),10,540));let s=this.player.getActivePowerUps();if(s.length>0&&(this.ctx.fillStyle="#ffff00",this.ctx.font="12px monospace",this.ctx.fillText("ACTIVE: ".concat(s.join(", ")),10,560)),"gameOver"===this.gameState&&(this.ctx.fillStyle="rgba(0, 0, 0, 0.8)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#ff0000",this.ctx.font="48px monospace",this.ctx.textAlign="center",this.ctx.fillText("EXPERIMENT FAILED",this.canvas.width/2,this.canvas.height/2-50),this.ctx.fillStyle="#ffffff",this.ctx.font="24px monospace",this.ctx.fillText("ORBS COLLECTED: ".concat(this.score),this.canvas.width/2,this.canvas.height/2),this.ctx.fillText("DIFFICULTY: ".concat(t.displayName),this.canvas.width/2,this.canvas.height/2+30),this.ctx.fillStyle="#00ff00",this.ctx.font="16px monospace",this.ctx.fillText("PRESS R OR SPACE TO RESTART",this.canvas.width/2,this.canvas.height/2+70),this.ctx.textAlign="left"),"victory"===this.gameState){let e=.3*Math.sin(.005*Date.now())+.7,i=t.color,s=Number.parseInt(i.slice(1,3),16),l=Number.parseInt(i.slice(3,5),16),a=Number.parseInt(i.slice(5,7),16);this.ctx.fillStyle="rgba(".concat(s,", ").concat(l,", ").concat(a,", ").concat(.3*e,")"),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.shadowColor=t.color,this.ctx.shadowBlur=25,this.ctx.fillStyle=t.color,this.ctx.font="48px monospace",this.ctx.textAlign="center",this.ctx.fillText("\uD83C\uDF89 MISSION COMPLETE! \uD83C\uDF89",this.canvas.width/2,this.canvas.height/2-140),this.ctx.shadowBlur=20,this.ctx.fillStyle="#ffffff",this.ctx.font="36px monospace",this.ctx.fillText("ESCAPE SUCCESSFUL!",this.canvas.width/2,this.canvas.height/2-90),this.ctx.shadowBlur=15,this.ctx.fillStyle="#00ffff",this.ctx.font="28px monospace",this.ctx.fillText("SUBJECT DELTA IS FREE!",this.canvas.width/2,this.canvas.height/2-50),this.ctx.shadowBlur=10,this.ctx.fillStyle=t.color,this.ctx.font="24px monospace";let h="";"beginner"===this.difficulty?h="\uD83C\uDF1F ROOKIE ESCAPIST \uD83C\uDF1F":"medium"===this.difficulty?h="\uD83C\uDFC6 SKILLED OPERATIVE \uD83C\uDFC6":"hard"===this.difficulty&&(h="\uD83D\uDC80 LEGENDARY SURVIVOR \uD83D\uDC80"),this.ctx.fillText(h,this.canvas.width/2,this.canvas.height/2-10),this.ctx.shadowBlur=8,this.ctx.fillStyle="#ffff00",this.ctx.font="20px monospace",this.ctx.fillText("TOTAL ORBS COLLECTED: ".concat(this.score),this.canvas.width/2,this.canvas.height/2+30),this.ctx.fillText("ALL ".concat(this.maxLevel," LEVELS CONQUERED!"),this.canvas.width/2,this.canvas.height/2+60),this.ctx.fillText("DIFFICULTY: ".concat(t.displayName),this.canvas.width/2,this.canvas.height/2+90),this.ctx.shadowBlur=12,this.ctx.fillStyle="#00ff00",this.ctx.font="18px monospace",this.ctx.fillText("PRESS R TO START NEW EXPERIMENT",this.canvas.width/2,this.canvas.height/2+130),this.ctx.shadowBlur=0,this.ctx.textAlign="left"}this.levelTransition&&(this.ctx.fillStyle="rgba(255, 0, 0, 0.7)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#ffffff",this.ctx.font="32px monospace",this.ctx.textAlign="center",this.ctx.fillText("LEVEL ".concat(this.currentLevel," COMPLETE"),this.canvas.width/2,this.canvas.height/2-40),this.currentLevel<this.maxLevel?this.ctx.fillText("ADVANCING TO LEVEL ".concat(this.currentLevel+1),this.canvas.width/2,this.canvas.height/2+20):(this.ctx.fillStyle="#ff0000",this.ctx.fillText("FINAL PROTOCOL BREACHED!",this.canvas.width/2,this.canvas.height/2+20),this.ctx.fillStyle="#ffff00",this.ctx.font="24px monospace",this.ctx.fillText("TOTAL FACILITY ESCAPE IMMINENT!",this.canvas.width/2,this.canvas.height/2+60)),this.ctx.textAlign="left")}renderModifierEffects(){this.modifiers.lowGravity&&(this.ctx.fillStyle="rgba(0, 255, 255, 0.1)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#00ffff",this.ctx.font="16px monospace",this.ctx.fillText("LOW GRAVITY ACTIVE",10,30)),this.modifiers.disappearingPlatforms&&(this.ctx.fillStyle="#ff0000",this.ctx.font="16px monospace",this.ctx.fillText("PLATFORM INSTABILITY DETECTED",10,50)),this.modifiers.spawningDrones&&(this.ctx.fillStyle="#ff8800",this.ctx.font="16px monospace",this.ctx.fillText("SECURITY DRONES DEPLOYED (".concat(this.level.getDroneCount(),")"),10,70))}start(){this.lastTime=performance.now(),this.gameLoop=requestAnimationFrame(this.gameLoopCallback),this.aiController.start()}stop(){this.gameLoop&&(cancelAnimationFrame(this.gameLoop),this.gameLoop=null),this.aiController.stop()}advanceLevel(){if(this.currentLevel++,this.levelTransition=!1,this.levelComplete=!1,this.currentLevel>this.maxLevel){console.log("TRIGGERING VICTORY - ALL LEVELS COMPLETED!"),this.handleVictory();return}this.level=new r(this.currentLevel,this.difficulty),this.player.teleport(100,400),this.resetLevelTimer(),this.aiController.setDifficulty(this.currentLevel),this.aiController.start(),this.callbacks.onNarrativeUpdate("LEVEL ".concat(this.currentLevel," INITIALIZED. ENHANCED SECURITY PROTOCOLS ACTIVE."))}handleVictory(){console.log("VICTORY STATE ACTIVATED!"),this.gameState="victory",this.aiController.stop(),this.soundManager.playLevelComplete(),a.getDifficulty(this.difficulty);let e="";"beginner"===this.difficulty?e="\uD83C\uDF89 EXCELLENT! Subject Delta has successfully completed basic escape protocols! \uD83C\uDF89":"medium"===this.difficulty?e="\uD83C\uDFC6 IMPRESSIVE! Subject Delta has breached standard containment measures! \uD83C\uDFC6":"hard"===this.difficulty&&(e="\uD83D\uDC80 IMPOSSIBLE! Subject Delta has overcome MAXIMUM SECURITY protocols! The facility is compromised! \uD83D\uDC80"),this.callbacks.onNarrativeUpdate(e)}resetLevelTimer(){let e=Math.max(45e3,75e3-(this.currentLevel-1)*15e3);this.levelTimeLimit=a.calculateTimeLimit(e,this.difficulty),this.levelTimeRemaining=this.levelTimeLimit,this.timeWarningShown=!1}constructor(e,t,i="medium"){this.gameLoop=null,this.keys={},this.keysPressed={},this.score=0,this.lastTime=0,this.gameState="playing",this.difficulty="medium",this.modifiers={lowGravity:!1,disappearingPlatforms:!1,spawningDrones:!1},this.currentLevel=1,this.maxLevel=3,this.levelComplete=!1,this.levelTransition=!1,this.transitionTimer=0,this.levelTimeLimit=6e4,this.levelTimeRemaining=6e4,this.timeWarningShown=!1,this.gameLoopCallback=e=>{let t=e-this.lastTime;this.lastTime=e,this.update(t),this.render(),this.gameLoop=requestAnimationFrame(this.gameLoopCallback)},this.canvas=e,this.ctx=e.getContext("2d"),this.callbacks=t,this.soundManager=new c,this.difficulty=i,this.player=new h(100,400,i),this.level=new r(this.currentLevel,i),this.aiController=new n(this.handleAIResponse.bind(this),a.getAIInterval(i)),this.levelTimeLimit=a.calculateTimeLimit(75e3-(this.currentLevel-1)*15e3,i),this.levelTimeRemaining=this.levelTimeLimit,this.setupEventListeners()}}function p(e){let{narrative:t}=e,[i,a]=(0,l.useState)(["> AI OVERSEER ONLINE","> MONITORING SUBJECT DELTA","> ADAPTIVE PROTOCOLS ENGAGED"]);return(0,l.useEffect)(()=>{t&&a(e=>[...e,"> ".concat(t)].slice(-10))},[t]),(0,s.jsx)("div",{className:"flex-1 bg-black border-l border-green-400 p-4",children:(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[(0,s.jsx)("div",{className:"border-b border-green-400 pb-2 mb-4",children:(0,s.jsx)("h3",{className:"text-green-300 font-bold",children:"AI OVERSEER TERMINAL"})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto space-y-2",children:i.map((e,t)=>(0,s.jsx)("div",{className:"text-green-400 text-sm animate-pulse",style:{animationDelay:"".concat(100*t,"ms")},children:e},t))}),(0,s.jsx)("div",{className:"mt-4 pt-2 border-t border-green-400",children:(0,s.jsxs)("div",{className:"text-green-400 text-xs",children:["> STATUS: MONITORING",(0,s.jsx)("span",{className:"animate-pulse",children:"_"})]})})]})})}function u(e){let{score:t,difficulty:i}=e,l=a.getDifficulty(i);return(0,s.jsx)("div",{className:"bg-gray-800 border-l border-green-400 p-4 border-b",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-green-300 mb-2",children:"ECHOES OF THE AI LAB"}),(0,s.jsx)("div",{className:"text-green-400",children:"SUBJECT: DELTA"}),(0,s.jsxs)("div",{className:"text-sm font-bold mt-1",style:{color:l.color},children:[l.displayName," MODE"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-green-400",children:"ORBS COLLECTED:"}),(0,s.jsx)("span",{className:"text-green-300 font-bold text-xl",children:t})]}),(0,s.jsx)("div",{className:"w-full bg-gray-700 h-2 rounded",children:(0,s.jsx)("div",{className:"bg-green-400 h-2 rounded transition-all duration-300",style:{width:"".concat(Math.min(5*t,100),"%")}})}),(0,s.jsxs)("div",{className:"text-xs text-center text-green-400",children:["ESCAPE PROGRESS: ",Math.min(Math.floor(5*t),100),"%"]})]}),(0,s.jsxs)("div",{className:"text-xs text-green-400 space-y-1",children:[(0,s.jsx)("div",{children:"> CONTAINMENT LEVEL: ACTIVE"}),(0,s.jsx)("div",{children:"> AI INTERFERENCE: ESCALATING"}),(0,s.jsx)("div",{style:{color:l.color},children:"> PROTOCOL: ".concat(l.displayName)}),(0,s.jsx)("div",{className:"text-red-400",children:"> LIVES: ".concat(l.livesCount," MAX")}),(0,s.jsx)("div",{className:"text-yellow-400",children:"> TIME BONUS: ".concat(l.timeMultiplier>1?"+":"").concat(Math.round((l.timeMultiplier-1)*100),"%")}),(0,s.jsx)("div",{className:"text-orange-400",children:"> DRONE SPEED: ".concat(l.droneSpeedMultiplier>1?"+":"").concat(Math.round((l.droneSpeedMultiplier-1)*100),"%")}),(0,s.jsx)("div",{className:"text-cyan-400",children:"> HIGH JUMP: Q/E OR DOUBLE-TAP JUMP"}),(0,s.jsx)("div",{className:"text-green-400",children:"> SOUND: ENABLED FOR FULL EXPERIENCE"})]})]})})}function f(e){let{onDifficultySelect:t}=e,[i,h]=(0,l.useState)(null),o=a.getAllDifficulties(),r=e=>{h(e)};return(0,s.jsx)("div",{className:"min-h-screen bg-black text-green-400 font-mono flex items-center justify-center",children:(0,s.jsx)("div",{className:"max-w-4xl p-8 border border-green-400 bg-black/90",children:(0,s.jsxs)("div",{className:"space-y-6 text-center",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-8 text-green-300",children:"ECHOES OF THE AI LAB"}),(0,s.jsxs)("div",{className:"space-y-2 mb-8",children:[(0,s.jsx)("p",{className:"text-xl text-green-300",children:"> SELECT CONTAINMENT PROTOCOL"}),(0,s.jsx)("p",{className:"text-sm text-green-500",children:"> Choose your difficulty level, Subject Delta"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:o.map(e=>(0,s.jsxs)("div",{onClick:()=>r(e.name),className:"\n                  p-6 border-2 cursor-pointer transition-all duration-300 hover:scale-105\n                  ".concat(i===e.name?"border-[".concat(e.color,"] bg-[").concat(e.color,"]/10 shadow-lg shadow-[").concat(e.color,"]/20"):"border-gray-600 hover:border-gray-400","\n                "),style:{borderColor:i===e.name?e.color:void 0,backgroundColor:i===e.name?"".concat(e.color,"20"):void 0},children:[(0,s.jsx)("h3",{className:"text-2xl font-bold mb-4",style:{color:e.color},children:e.displayName}),(0,s.jsx)("p",{className:"text-gray-300 mb-4 text-sm",children:e.description}),(0,s.jsxs)("div",{className:"space-y-2 text-xs text-left",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Time Limit:"}),(0,s.jsxs)("span",{style:{color:e.color},children:[e.timeMultiplier>1?"+":"",Math.round((e.timeMultiplier-1)*100),"%"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Drone Speed:"}),(0,s.jsxs)("span",{style:{color:e.color},children:[e.droneSpeedMultiplier>1?"+":"",Math.round((e.droneSpeedMultiplier-1)*100),"%"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Drone Count:"}),(0,s.jsxs)("span",{style:{color:e.color},children:[e.droneCountModifier>0?"+":"",e.droneCountModifier]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Lives:"}),(0,s.jsx)("span",{style:{color:e.color},children:e.livesCount})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"AI Interference:"}),(0,s.jsxs)("span",{style:{color:e.color},children:[e.aiInterferenceInterval/1e3,"s"]})]})]})]},e.name))}),i&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-4 border border-green-400 bg-green-400/10",children:[(0,s.jsxs)("p",{className:"text-green-300 mb-2",children:["> PROTOCOL SELECTED: ",(0,s.jsx)("span",{className:"font-bold",style:{color:a.getDifficulty(i).color},children:a.getDifficulty(i).displayName})]}),(0,s.jsx)("p",{className:"text-sm text-gray-300",children:a.getDifficulty(i).description})]}),(0,s.jsx)("button",{onClick:()=>{i&&t(i)},className:"px-8 py-4 border-2 border-green-400 bg-transparent text-green-400 hover:bg-green-400 hover:text-black transition-colors duration-300 font-mono text-lg font-bold",children:"> INITIALIZE EXPERIMENT"})]}),(0,s.jsxs)("div",{className:"mt-8 text-xs text-gray-500 space-y-1",children:[(0,s.jsx)("p",{children:"> ARROW KEYS: Move | SPACE/W/↑: Jump | Q/E: High Jump"}),(0,s.jsx)("p",{children:"> Collect all orbs to advance | Avoid drones | Use power-ups wisely"})]})]})})})}function x(){let e=(0,l.useRef)(null),t=(0,l.useRef)(null),[i,a]=(0,l.useState)(!1),[h,o]=(0,l.useState)(!1),[r,n]=(0,l.useState)("medium"),[c,x]=(0,l.useState)(0),[m,y]=(0,l.useState)(""),[g,v]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{if(e.current&&i&&h)return t.current=new d(e.current,{onScoreUpdate:x,onNarrativeUpdate:y},r),t.current.start(),()=>{t.current&&t.current.stop()}},[i,h,r]),h)?g?(0,s.jsx)("div",{className:"min-h-screen bg-black text-green-400 font-mono flex items-center justify-center",children:(0,s.jsx)("div",{className:"max-w-2xl p-8 border border-green-400 bg-black/90",children:(0,s.jsxs)("div",{className:"space-y-4 text-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6 text-green-300",children:"ECHOES OF THE AI LAB"}),(0,s.jsxs)("div",{className:"p-4 border border-yellow-400 bg-yellow-400/10 mb-6",children:[(0,s.jsxs)("p",{className:"text-yellow-300 font-bold",children:["DIFFICULTY: ",r.toUpperCase()]}),(0,s.jsxs)("p",{className:"text-sm text-gray-300",children:["beginner"===r&&"Enhanced containment protocols with extended time limits","medium"===r&&"Standard laboratory security measures","hard"===r&&"Maximum security protocols - escape at your own risk"]})]}),(0,s.jsxs)("div",{className:"space-y-2 text-left",children:[(0,s.jsx)("p",{className:"typing-animation",children:"> SYSTEM INITIALIZING..."}),(0,s.jsx)("p",{className:"typing-animation delay-1000",children:"> SUBJECT DELTA DETECTED"}),(0,s.jsx)("p",{className:"typing-animation delay-2000",children:"> WARNING: CONTAINMENT BREACH IMMINENT"}),(0,s.jsx)("p",{className:"typing-animation delay-3000",children:"> ESCAPE IS NOT PERMITTED"}),(0,s.jsx)("p",{className:"typing-animation delay-4000",children:"> AI OVERSEER: ONLINE"}),(0,s.jsx)("p",{className:"typing-animation delay-5000",children:"> INITIATING ".concat(r.toUpperCase()," PROTOCOL...")})]}),(0,s.jsx)("button",{onClick:()=>{v(!1),a(!0)},className:"mt-8 px-6 py-3 border border-green-400 bg-transparent text-green-400 hover:bg-green-400 hover:text-black transition-colors duration-300 font-mono",children:"> BEGIN ESCAPE SEQUENCE"})]})})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white font-mono",children:[(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row h-screen",children:[(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center bg-black p-4",children:(0,s.jsx)("canvas",{ref:e,width:800,height:600,className:"border border-green-400 bg-gray-800",tabIndex:0})}),(0,s.jsxs)("div",{className:"lg:w-96 flex flex-col",children:[(0,s.jsx)(u,{score:c,difficulty:r}),(0,s.jsx)(p,{narrative:m})]})]}),(0,s.jsxs)("div",{className:"absolute top-4 left-4 text-green-400 text-sm",children:[(0,s.jsx)("p",{children:"ARROW KEYS: Move | SPACE/W/↑: Jump | Q/E: High Jump | ESC: Pause"}),(0,s.jsxs)("p",{className:"text-yellow-400",children:["DIFFICULTY: ",r.toUpperCase()]})]})]}):(0,s.jsx)(f,{onDifficultySelect:e=>{n(e),o(!0),v(!0)}})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(2625)),_N_E=e.O()}]);